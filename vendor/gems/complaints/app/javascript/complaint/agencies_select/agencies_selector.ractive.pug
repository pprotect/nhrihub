.div(style='display:flex;')
  select.dupe_check.form-control#agencies_select(value='{{agency_select_params.top_level_category}}')
    option#prompt(disabled=true, selected='selected') select...
    option(value="national") National
    option(value="provincial_agencies") Provincial
    option(value="municipalities") Local
  .secondary('class-show'="national")
    <nationalAgenciesSelect agency_select_params='{{agency_select_params}}' national_agencies='{{national_agencies}}' />
  .secondary('class-show'="provincial")
    <provincialAgenciesSelect agency_select_params='{{agency_select_params}}' provinces='{{provinces}}' provincial_agencies='{{provincial_agencies}}' />
  .secondary('class-show'="local")
    <localAgenciesSelect agency_select_params='{{agency_select_params}}' provinces='{{provinces}}' districts='{{districts}}' metro_municipalities='{{metro_municipalities}}' />
  #add_agency('class-show'='has_agency', 'on-click'='@this.parent.add_agency()')
    .btn.btn-default.btn-success
      i.fa.fa-plus.fa-lg

style.
  #agencies_select {
    width: 140px;
  }
  option#prompt {
    color: #333;
  }
  .secondary { display: none; }
  .secondary.show {display: flex !important; }
  #add_agency {
    display: none;
  }
  #add_agency .btn {
    height: 31px;
    top: 2px;
    position: relative;
    width: 31px;
    padding-top: 4px;
    padding-left: 7px;
  }
  #add_agency .btn i{
    color: white;
  }

script.
  import NationalAgenciesSelect from './national_agencies_select.ractive.pug'
  import ProvincialAgenciesSelect from './provincial_agencies_select.ractive.pug'
  import LocalAgenciesSelect from './local_agencies_select.ractive.pug'

  export default Ractive.extend({
    template : $TEMPLATE,
    css: $CSS,
    components:{
      nationalAgenciesSelect: NationalAgenciesSelect,
      provincialAgenciesSelect: ProvincialAgenciesSelect,
      localAgenciesSelect: LocalAgenciesSelect,
    },
    computed:{
      national(){ return this.get('agency_select_params.top_level_category') == 'national' },
      provincial(){ return this.get('agency_select_params.top_level_category') == 'provincial_agencies' },
      local(){ return this.get('agency_select_params.top_level_category') == 'municipalities' },
      national_agencies(){return       _(this.get('agencies')).findWhere({name: 'National'}).collection },
      provincial_agencies(){return     _(this.get('agencies')).findWhere({name: 'Provincial'}).collection },
      district_municipalities(){return _(this.get('agencies')).findWhere({name: 'Local'}).collection },
      agency_id:{
        get(){
          if(this.get('national')){
              return this.findComponent('nationalAgenciesSelect').get('agency_id')
            }else if(this.get('provincial')){
              return this.findComponent('provincialAgenciesSelect').get('agency_id')
            }else if(this.get('local')){
              return this.findComponent('localAgenciesSelect').get('agency_id')
            }
        },
        set(val){
          if(this.get('national')){
              this.findComponent('nationalAgenciesSelect').set('agency_id', val)
            }else if(this.get('provincial')){
              this.findComponent('provincialAgenciesSelect').set('agency_id', val)
            }else if(this.get('local')){
              this.findComponent('localAgenciesSelect').set('agency_id', val)
            }
        }
      },
      has_agency(){
        var id = this.get('agency_id')
        return _.isNumber(id) && (id != 0)
      }
    },
  });
