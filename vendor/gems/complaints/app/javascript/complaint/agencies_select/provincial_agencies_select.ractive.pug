select.dupe_check.form-control#provinces_select(value='{{agency_select_params.selected_province_id}}')
  option#prompt(value="0", disabled=true, selected=true) select province...
  | {{#provinces}}
  option(value='{{id}}') {{name}}
  | {{/provinces}}
.tertiary('class-show'='province_selected')
  <provincialAgencySelect agency_select_params='{{agency_select_params}}' collection='{{collection}}' tertiary_key='{{tertiary_key}}' />

style.
  .tertiary {
    display: none;
  }
  #provinces_select {
    width: 140px;
  }
  option#prompt {
    color: #333;
  }

script.
  import ProvincialAgencySelect from './provincial_agency_select.ractive.pug'

  export default Ractive.extend({
    template : $TEMPLATE,
    css: $CSS,
    components: {
      provincialAgencySelect: ProvincialAgencySelect,
    },
    computed:{
      collection(){
        return this.get('provincial_agencies')[this.get('agency_select_params.selected_province_id')]
      },
      province_selected(){
        var sel = this.get('agency_select_params.selected_province_id')
        return !_.isUndefined(sel) && (sel != "0")
      },
      selected_province(){
        return _(this.get('provinces')).findWhere({id: this.get('agency_select_params.selected_province_id')})
      },
      tertiary_key(){
        if(this.get('province_selected')){
          return this.get('selected_province').name.underscore()
        }
      },
      agency_id:{
        get(){
          if(this.get('province_selected')){
            return this.get('agency_select_params.provincial_agency_id')
            }
        },
        set(val){
            this.set('agency_select_params.provincial_agency_id',val)
        }
      },
    },
  })
